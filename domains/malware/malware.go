package domains

import "github.com/thanhpk/randstr"

type malware_t struct {
	malware_name string   // Malware name (This is the binary name of the file)
	content      []string // The code that the malware does will be contained here
	extension    string
}

var c_malw malware_t

func SetBinaryName(new_name string) {
	c_malw.malware_name = new_name
}

func AddContent(new_cont string) {
	c_malw.content = append(c_malw.content, new_cont)
}

func GetName() string {
	return c_malw.malware_name
}

func GetContent() []string {
	return c_malw.content
}

func SetExtension(new_ext string) {
	if new_ext[0:1] != "." { // Add the . if the user didn't supply it
		new_ext = "." + new_ext
	}
	c_malw.extension = new_ext
}
func GetExtension() string {
	return c_malw.extension
}

func AddRandomVariable() {
	var new_var string = randstr.String(64)
	AddContent("var " + new_var + " string")
	AddContent("fmt.Println(" + new_var + ")")
}

func AddRandomFunction() {
	var new_func string = randstr.String(64)
	AddContent(new_func + " := func(){}")
	AddContent(new_func + "()")
}
